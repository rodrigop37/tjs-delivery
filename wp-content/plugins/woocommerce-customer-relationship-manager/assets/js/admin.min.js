jQuery(function(a){function c(){"undefined"!=typeof wc_crm_params&&"undefined"!=typeof wc_crm_params.countries&&(b=a.parseJSON(wc_crm_params.countries.replace(/&quot;/g,'"'))),a(".overlay_media_popup .media-modal-close").click(function(b){return a(this).closest(".overlay_media_popup").hide(),!1}),a(".open_c_notes").click(n),a("#recipients").length>0&&jQuery("#recipients").textboxlist({unique:!0,bitsOptions:{editable:{addKeys:[188]}}}),a("#woocommerce-customer-notes").length>0&&(a("#woocommerce-customer-notes").on("click","a.add_note_customer",l),a("#woocommerce-customer-notes").on("click","a.delete_customer_note",m)),a(".customerdelete").click(function(b){a("#delete_customer_popup").show();var c=a(this).data("cid");return a("#wc_crm_delete_customer_ids").val(c),!1}),a("#wc_crm_customers_form").submit(function(b){if("delete"==a("#bulk-action-selector-top").val()||"delete"==a("#bulk-action-selector-bottom").val()){a("#delete_customer_popup").show();var c=[];a("#the-list .check-column input:checked").each(function(b,d){c.push(a(d).val())});var d=c.join(",");return console.log(d),a("#wc_crm_delete_customer_ids").val(d),!1}}),a("#delete_customer_form").submit(function(b){return a(".delete_customer_input:checked").length?void 0:!1}),a("#_billing_country").length>0&&(a(".js_field-country").change(j),a(".js_field-country").trigger("change",[!0]),a(document.body).on("change","select.js_field-state",k),a("a.edit_address").click(e),a("a.billing-same-as-shipping").on("click",f),a("a.load_customer_billing").on("click",g),a("a.load_customer_shipping").on("click",h)),a("#customer_address_map_canvas").length>0&&i(),a("#customer_data #excerpt").length>0&&a("#customer_data #excerpt").closest("p").remove(),a("#wc_crm_edit_customer_form").length>0&&(a(document.body).on("click",".show_order_items",function(){return a(this).closest("td").find("table").toggle(),!1}),a("#wc_crm_edit_customer_form").submit(function(){if(a("#wc_crm_customer_action").length){var b=a("#wc_crm_customer_action").val();if(""!=b){var c=a("#wc_crm_customer_action option:selected").data("url");return window.open(c,"_blank"),!1}}})),a("#date_of_birth").length>0&&(a("#date_of_birth").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,changeMonth:!0,changeYear:!0,yearRange:"-100y:c+nn",maxDate:"-1d"}),a(".handlediv").click(function(){a(this).parent().toggleClass("closed")})),a(".wc_crm_date").length>0&&(a(".wc_crm_date").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,changeMonth:!0,changeYear:!0,minDate:"0d"}),a(".handlediv").click(function(){a(this).parent().toggleClass("closed")}))}function d(){a("#tiptip_holder").removeAttr("style"),a("#tiptip_arrow").removeAttr("style"),a(".tips").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})}function e(b){b.preventDefault(),a(this).hide(),a(this).parent().find("a:not(.edit_address)").show(),a(this).closest(".order_data_column").find("div.address").hide(),a(this).closest(".order_data_column").find("div.edit_address").show()}function f(b){return window.confirm(wc_crm_params.copy_billing)&&(a("input#_shipping_first_name").val(a("input#_billing_first_name").val()).change(),a("input#_shipping_last_name").val(a("input#_billing_last_name").val()).change(),a("input#_shipping_company").val(a("input#_billing_company").val()).change(),a("input#_shipping_address_1").val(a("input#_billing_address_1").val()).change(),a("input#_shipping_address_2").val(a("input#_billing_address_2").val()).change(),a("input#_shipping_city").val(a("input#_billing_city").val()).change(),a("input#_shipping_postcode").val(a("input#_billing_postcode").val()).change(),a("#_shipping_country").val(a("#_billing_country").val()).change(),a("#_shipping_state").val(a("#_billing_state").val()).change()),!1}function g(b){if(!0===b||window.confirm(wc_crm_params.load_billing)){var c=parseInt(a("#user_id").val()),d=parseInt(a("#order_id").val()),e={order_id:d,type_to_load:"billing",action:"wc_crm_get_guest_details",security:wc_crm_params.get_customer_details_nonce};if(c>0)var e={user_id:c,type_to_load:"billing",action:"woocommerce_get_customer_details",security:wc_crm_params.get_customer_details_nonce};a(this).closest("div.order_data_column").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),a.ajax({url:wc_crm_params.ajax_url,data:e,type:"POST",success:function(b){var c=b;c&&(a("input#_billing_first_name").val(c.billing_first_name).change(),a("input#_billing_last_name").val(c.billing_last_name).change(),a("input#_billing_company").val(c.billing_company).change(),a("input#_billing_address_1").val(c.billing_address_1).change(),a("input#_billing_address_2").val(c.billing_address_2).change(),a("input#_billing_city").val(c.billing_city).change(),a("input#_billing_postcode").val(c.billing_postcode).change(),a("#_billing_country").val(c.billing_country).change(),a("#_billing_state").val(c.billing_state).change(),a("input#_billing_email").val(c.billing_email).change(),a("input#_billing_phone").val(c.billing_phone).change()),a("div.order_data_column").unblock()}})}return!1}function h(b){if(!0===b||window.confirm(wc_crm_params.load_shipping)){var c=parseInt(a("#user_id").val()),d=parseInt(a("#order_id").val()),e={order_id:d,type_to_load:"shipping",action:"wc_crm_get_guest_details",security:wc_crm_params.get_customer_details_nonce};if(c>0)var e={user_id:c,type_to_load:"shipping",action:"woocommerce_get_customer_details",security:wc_crm_params.get_customer_details_nonce};a(this).closest("div.order_data_column").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),a.ajax({url:wc_crm_params.ajax_url,data:e,type:"POST",success:function(b){var c=b;c&&(a("input#_shipping_first_name").val(c.shipping_first_name).change(),a("input#_shipping_last_name").val(c.shipping_last_name).change(),a("input#_shipping_company").val(c.shipping_company).change(),a("input#_shipping_address_1").val(c.shipping_address_1).change(),a("input#_shipping_address_2").val(c.shipping_address_2).change(),a("input#_shipping_city").val(c.shipping_city).change(),a("input#_shipping_postcode").val(c.shipping_postcode).change(),a("#_shipping_country").val(c.shipping_country).change(),a("#_shipping_state").val(c.shipping_state).change()),a("div.order_data_column").unblock()}})}return!1}function i(){"undefined"!=typeof a().gmap?a("#customer_address_map_canvas .canvas").gmap({zoom:14,zoomControl:!0,mapTypeControl:!1,navigationControl:!1,streetViewControl:!1}).bind("init",function(){a("#customer_address_map_canvas .canvas").gmap("search",{address:wc_pos_customer_formatted_billing_address},function(b,c){"OK"===c&&(a("#customer_address_map_canvas .canvas").gmap("get","map").panTo(b[0].geometry.location),a("#customer_address_map_canvas .canvas").gmap("addMarker",{position:b[0].geometry.location,bounds:!1}))})}):setTimeout(function(){acf.fields.google_map.set({$el:jQuery("#customer_address_map_canvas input.search").closest(".acf-google-map")}).edit();var a=acf.fields.google_map,b=a.map.$el,c=wc_pos_customer_formatted_billing_address;b.find(".input-address").val(c),b.find(".title h4").text(c),a.geocoder.geocode({address:c},function(c,d){if(d!=google.maps.GeocoderStatus.OK)return void console.log("Geocoder failed due to: "+d);if(!c[0])return void console.log("No results found");place=c[0];var e=place.geometry.location.lat(),f=place.geometry.location.lng();a.set({$el:b}).update(e,f).center()})},2e3)}function j(c,d){if("undefined"==typeof d&&(d=!1),null!==b){var e=a(this),f=e.val(),g=e.parents("div.edit_address").find(":input.js_field-state"),h=g.parent(),i=g.attr("name"),j=g.attr("id"),k=e.data("woocommerce.stickState-"+f)?e.data("woocommerce.stickState-"+f):g.val(),l=g.attr("placeholder");if(d&&e.data("woocommerce.stickState-"+f,k),h.show().find(".select2-container").remove(),a.isEmptyObject(b[f]))g.replaceWith('<input type="text" class="js_field-state" name="'+i+'" id="'+j+'" value="'+k+'" placeholder="'+l+'" />');else{var m=a('<select name="'+i+'" id="'+j+'" class="js_field-state select short" placeholder="'+l+'"></select>'),n=b[f];m.append(a('<option value="">'+wc_crm_params.i18n_select_state_text+"</option>")),a.each(n,function(b){m.append(a('<option value="'+b+'">'+n[b]+"</option>"))}),m.val(k),g.replaceWith(m),m.show().select2().hide().change()}a(document.body).trigger("contry-change.woocommerce",[f,a(this).closest("div")])}}function k(b){var c=a(this),d=c.val(),e=c.parents("div.edit_address").find(":input.js_field-country"),f=e.val();e.data("woocommerce.stickState-"+f,d)}function l(b){if(a("textarea#add_order_note").val()){a("#woocommerce-customer-notes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var c={action:"wc_crm_add_customer_note",customer_id:a("#customer_id").val(),note:a("textarea#add_order_note").val()};return a.post(wc_crm_params.ajax_url,c,function(b){a("ul.order_notes").prepend(b),a("#woocommerce-customer-notes").unblock(),a("#add_order_note").val("")}),!1}}function m(b){var c=a(this).closest("li");a(c).block({message:null,overlayCSS:{background:"#fff url("+wc_crm_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}});var d={action:"wc_crm_delete_customer_note",note_id:a(c).attr("rel")};return a.post(wc_crm_params.ajax_url,d,function(b){a(c).remove()}),!1}function n(b){a("#customer_notes_popup iframe").attr("src",""),a("#customer_notes_popup > .media-modal").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var c=a(this).attr("href");return a("#customer_notes_popup iframe").attr("src",c),a("#customer_notes_popup").show(),!1}var b=null;c(),d()});